---
title: "HW2"
author: "Joy Lin"
date: "2025-01-26"
output: pdf_document
---

# Question One

```{r}

library(ggplot2)
profs <- read.csv('profs.csv')
ggplot(profs,(aes(x=eval))) + geom_histogram(bin=30, col='black', fill='blue') + labs(title='Distribution of Professor Evaluation')

```

```{r}
ggplot(profs, (aes(x=eval))) + geom_boxplot(col='black', fill= "pink")+facet_wrap('native')+ labs(title = 'Distribution of Course Evaluation for Native and Non-Native Speakers')
```

```{r}
ggplot(profs, (aes(x=eval))) + geom_histogram(bin=30, col='black') + facet_wrap('gender') + labs(title='Distribution of Course Evaluation for Female and Male Professor')
```

```{r}
ggplot(profs, (aes(x=beauty, y=eval)))+ geom_point()+ labs(title = "Beauty score vs Course Evaluation Score")
```

## Question 2

```{r}
bikeshare=read.csv("bikeshare.csv")
library(dplyr)
bikeshare1<-bikeshare %>% 
  group_by(hr) %>%
    summarize(mean(total))
colnames(bikeshare1)[2]<-"total"
ggplot(bikeshare1, (aes(x=hr, y=total)))+geom_line()+labs(title='Average Bike Rentals for Each Hour')

```


```{r}
bikeshare2 <- bikeshare %>%
  group_by(hr, workingday) %>%
  summarize(avg_total = mean(total, na.rm = TRUE))
bikeshare2 <- bikeshare2 %>%
  mutate(workingday = ifelse(workingday == 1, "yes", "no"))
ggplot(bikeshare2, (aes(x=hr, y=avg_total)))+geom_line()+facet_grid('workingday')+labs(title='Average Bike Rentals for Each Hour')

```


```{r}
bikeshare3 <- bikeshare %>%
  filter(hr == 9) %>%
    group_by(workingday, weathersit)%>%
    summarize(avg_total = mean(total, na.rm = TRUE))
bikeshare3 <- bikeshare3 %>%
  mutate(workingday = ifelse(workingday == 1, "yes", "no"))
ggplot(bikeshare3, (aes(x=weathersit, y=avg_total)))+geom_bar(stat='identity')+facet_grid('workingday')+labs(title='Average Bike Rentals for Each Weather Situation For the 9th Hour')

```


```{r}
capmetro<- read.csv("capmetro_UT.csv")
capmetro1 <- capmetro %>%
  group_by(hour_of_day, day_of_week, month) %>%
  summarize(avg_boarding = mean(boarding), .groups = "drop")
capmetro1$month<-factor(capmetro1$month,levels=c("Sep", "Oct", "Nov"))
capmetro1$day_of_week<-factor(capmetro1$day_of_week,levels=c("Sun","Mon","Tue","Wed","Thu", "Fri", "Sat"))

ggplot(capmetro1, aes(x = hour_of_day, y = avg_boarding, color = month, group = month)) +
  geom_line(size = 1.2) + 
  facet_wrap(day_of_week ~ .) + 
  scale_color_manual(values = c( "Sep" = "pink", "Oct" = "purple", "Nov" = "orange" )) +
  labs(
    title = "Average Boardings by Hour of Day, Faceted by Day of Week",
    x = "Hour of Day (24-hour time)",
    y = "Average Boardings",
    color = "Month",
    caption=""
  ) +
  theme_minimal() +
  theme(
    strip.text = element_text(size = 12, face = "bold"), # Larger facet titles
    legend.position = "bottom"
  )







```


```{r}
ggplot(capmetro1, aes(x = hour_of_day, y = avg_boarding, color = month, group = month)) +
  geom_line(size = 1.2) + 
  facet_wrap(day_of_week ~ .) + 
  scale_color_manual(values = c( "Sep" = "pink", "Oct" = "purple", "Nov" = "orange" )) +
  labs(
    title = "Average Boardings by Hour of Day, Faceted by Day of Week",
    x = "Hour of Day (24-hour time)",
    y = "Average Boardings",
    color = "Month",
    caption=""
  ) +
  theme_minimal() +
  theme(
    strip.text = element_text(size = 12, face = "bold"), # Larger facet titles
    legend.position = "bottom"
  )
```

```{r}
ggplot(capmetro, aes(x = temperature, y = boarding, color = weekend)) +
  geom_point(alpha = 0.4) + 
  facet_wrap(~ hour_of_day, ncol = 4) +
  labs(
    title = "Boardings vs. Temperature, Faceted by Hour of the Day",
    x = "Temperature (F)",
    y = "Number of Boardings",
    color = "Day Type",
    caption = "123"
  ) +
  theme_minimal() +
  theme(
    strip.text = element_text(size = 12, face = "bold"),
    legend.position = "right"
  )

```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# Load necessary libraries
library(dplyr)
library(readr)


billboard <- read.csv("billboard.csv")

top_songs <- billboard %>%
  group_by(performer, song) %>%
  summarize(count = n(), .groups = 'drop') %>%
  arrange(desc(count)) %>%
  slice_head(n = 10)
print(top_songs)
caption <- "Table showing the top 10 most popular songs on the Billboard Top 100 since 1958, based on the total number of weeks each song spent on the chart."
cat(caption)



library(dplyr)
library(readr)
library(ggplot2)
billboard_data <- read_csv("billboard.csv")
musical_diversity <- billboard_data %>%
  filter(year != 1958 & year != 2021) %>%  # Exclude years 1958 and 2021
  group_by(year) %>%
  summarize(unique_songs = n_distinct(song), .groups = 'drop')  # Count unique songs
ggplot(musical_diversity, aes(x = year, y = unique_songs)) +
  geom_line(color = "blue") +
  labs(
    title = "Musical Diversity of the Billboard Top 100 Over Time",
    x = "Year",
    y = "Number of Unique Songs",
    caption = "This graph shows the number of unique songs that appeared on the Billboard Top 100 chart each year, excluding 1958 and 2021."
  ) +
  theme_minimal()
print(musical_diversity)





# Load necessary libraries
library(dplyr)
library(readr)
library(ggplot2)


billboard_data <- read_csv("billboard.csv")

ten_week_hits <- billboard_data %>%
  group_by(performer, song) %>%
  summarize(weeks_on_chart = n(), .groups = 'drop') %>%
  filter(weeks_on_chart >= 10)  # Keep only songs with at least 10 weeks
ten_week_hits_count <- ten_week_hits %>%
  group_by(performer) %>%
  summarize(ten_week_hits = n(), .groups = 'drop') %>%
  filter(ten_week_hits >= 30)  # Keep artists with at least 30 hits
ggplot(ten_week_hits_count, aes(x = reorder(performer, ten_week_hits), y = ten_week_hits)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +  # Flip coordinates for better readability
  labs(
    title = "Artists with the Most Ten-Week Hits",
    x = "Artist",
    y = "Number of Ten-Week Hits",
    caption = "This bar plot shows the number of ten-week hits for artists who have achieved at least 30 ten-week hits on the Billboard Top 100 since 1958."
  ) +
  theme_minimal()

print(ten_week_hits_count)


```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
